"use client";

import { createContext, useContext, useEffect, useMemo, useState } from "react";

type Locale = "es" | "en" | "pt";

type I18nContextValue = {
  locale: Locale;
  setLocale: (locale: Locale) => void;
  t: (value: string) => string;
};

const translations: Record<Locale, Record<string, string>> = {
  es: {},
  en: {
    "Overview": "Overview",
    "Maestros": "Masters",
    "Usuarios": "Users",
    "Operaciones": "Operations",
    "Control": "Control",
    "Portales": "Portals",
    "Dashboard": "Dashboard",
    "Eventos": "Events",
    "Delegaciones": "Delegations",
    "Disciplinas": "Disciplines",
    "Flota": "Fleet",
    "Hotelería": "Hospitality",
    "Proveedores": "Providers",
    "Participantes": "Participants",
    "Encargado de delegación": "Delegation lead",
    "Sí": "Yes",
    "No": "No",
    "Conductores": "Drivers",
    "Viajes": "Trips",
    "Tracking de viajes": "Trip tracking",
    "Tracking hotelería": "Hotel tracking",
    "Incidentes": "Incidents",
    "Reportes": "Reports",
    "Portal de usuario": "User portal",
    "Portal Conductor": "Driver portal",
    "Centro de control": "Control center",
    "Estado general del evento": "Overall event status",
    "Monitorea llegadas, asignaciones y cambios operativos en un solo tablero. Este resumen conecta los módulos de transporte, hotelería y usuarios en tiempo real.": "Monitor arrivals, assignments, and operational changes in a single dashboard. This summary connects transport, hospitality, and user modules in real time.",
    "Operativo": "Operational",
    "Multievento": "Multi-event",
    "Llegadas a tiempo": "On-time arrivals",
    "12 delegaciones recibidas hoy": "12 delegations received today",
    "Cambios trazados": "Tracked changes",
    "Ultimas 24 horas": "Last 24 hours",
    "Asignaciones activas": "Active assignments",
    "Vehiculos y habitaciones": "Vehicles and rooms",
    "Reclamos": "Claims",
    "Pendientes de cierre": "Pending closure",
    "Prioridades operativas": "Operational priorities",
    "Revisar la roaming list de la delegación CAN y cerrar asignaciones de habitaciones.": "Review the roaming list for delegation CAN and close room assignments.",
    "Validar cambio de ruta para vehículo 23 por congestión en el acceso norte.": "Validate route change for vehicle 23 due to congestion on the north access.",
    "Coordinar el pre check-in digital con el hotel central para 2 delegaciones.": "Coordinate digital pre check-in with the central hotel for 2 delegations.",
    "KPIs clave": "Key KPIs",
    "Tiempo promedio de asignacion": "Average assignment time",
    "Adopcion App Conductor": "Driver app adoption",
    "Servicios extra controlados": "Extra services controlled",
    "Reclamos por logística": "Logistics claims",
    "Idioma": "Language",
    "Español": "Spanish",
    "English": "English",
    "Português": "Portuguese",
    "Modulo": "Module",
    "Editar registro": "Edit record",
    "Nuevo registro": "New record",
    "Cancelar edición": "Cancel edit",
    "Selecciona una opcion": "Select an option",
    "No hay viajes asignados aún.": "No trips assigned yet.",
    "Selecciona una delegación para cargar deportistas.": "Select a delegation to load athletes.",
    "Selecciona una delegación para cargar participantes.": "Select a delegation to load participants.",
    "Seleccionar todos": "Select all",
    "Limpiar": "Clear",
    "Actualizar": "Update",
    "Crear": "Create",
    "Registros": "Records",
    "Acciones": "Actions",
    "Refrescar": "Refresh",
    "Sin registros aún.": "No records yet.",
    "Editar": "Edit",
    "Eliminar": "Delete",
    "No se pudo cargar": "Could not load",
    "No se pudo actualizar": "Could not update",
    "No se pudo subir la foto": "Could not upload photo",
    "No se pudo leer la imagen": "Could not read the image",
    "Error al guardar": "Error while saving",
    "Error al eliminar": "Error while deleting",
    "Consulta tu itinerario y confirma cada etapa del viaje.": "Check your itinerary and confirm each trip stage.",
    "Tu ID de deportista": "Your athlete ID",
    "Tu ID de usuario": "Your user ID",
    "Ver mi información": "View my info",
    "Revisa tus viajes y reporta cada etapa del traslado.": "Review your trips and report each leg of the transfer.",
    "Tu ID de conductor": "Your driver ID",
    "Ver mis viajes": "View my trips",
    "Cargando...": "Loading...",
    "Perfil": "Profile",
    "Correo": "Email",
    "ID de conductor": "Driver ID",
    "Foto": "Photo",
    "Subir foto": "Upload photo",
    "Subiendo...": "Uploading...",
    "Sin foto": "No photo",
    "Viajes asignados": "Assigned trips",
    "No hay viajes asignados aún.": "No trips assigned yet.",
    "Viaje": "Trip",
    "Evento": "Event",
    "Eventos": "Events",
    "Nombre": "Name",
    "Fecha inicio": "Start date",
    "Fecha término": "End date",
    "Disciplinas": "Disciplines",
    "País": "Country",
    "Número de vuelo": "Flight number",
    "Aerolínea": "Airline",
    "Origen": "Origin",
    "Terminal": "Terminal",
    "Patente": "Plate",
    "Capacidad": "Capacity",
    "Capacidad total": "Total capacity",
    "Inventario por tipo de habitación": "Inventory by room type",
    "Inventario por tipo de cama": "Inventory by bed type",
    "Inventario de habitaciones": "Room inventory",
    "Inventario de camas": "Bed inventory",
    "Calculado automáticamente desde camas": "Automatically calculated from beds",
    "Debes ingresar al menos una cama.": "You must enter at least one bed.",
    "Habitaciones Single": "Single rooms",
    "Habitaciones Double": "Double rooms",
    "Habitaciones Triple": "Triple rooms",
    "Habitaciones Suite": "Suite rooms",
    "Camas Single": "Single beds",
    "Camas Double": "Double beds",
    "Camas Queen": "Queen beds",
    "Camas King": "King beds",
    "Estado": "Status",
    "Nombre completo": "Full name",
    "RUT": "RUT",
    "Correo electrónico": "Email",
    "Solicita tu código": "Request your code",
    "Código enviado al correo": "Code sent to your email",
    "Enviando...": "Sending...",
    "Volver": "Back",
    "El correo ingresado no está autorizado para solicitar el código.": "The email entered is not authorized to request the code.",
    "El correo ingresado no corresponde a un conductor registrado.": "The email entered does not belong to a registered driver.",
    "Licencia": "License",
    "Teléfono": "Phone",
    "Tipo de vehículo": "Vehicle type",
    "Marca": "Brand",
    "Modelo": "Model",
    "Estado vehículo": "Vehicle status",
    "Foto del conductor": "Driver photo",
    "Dieta": "Diet",
    "Tipo de equipaje": "Luggage type",
    "Hotel": "Hotel",
    "Vehículo": "Vehicle",
    "Tipo de viaje": "Trip type",
    "Tipo de cliente": "Client type",
    "Fecha programación": "Scheduled date",
    "Disponible": "Available",
    "En servicio": "In service",
    "Mantenimiento": "Maintenance",
    "Activo": "Active",
    "Inactivo": "Inactive",
    "Servicio": "Service",
    "Viaje": "Trip",
    "Recogido": "Picked up",
    "Dejado en hotel": "Dropped off at hotel",
    "Viaje completado": "Trip completed",
    "Tipo de usuario": "User type",
    "Vuelo": "Flight",
    "Hotel": "Hotel",
    "Transporte": "Transport",
    "Arribo": "Arrival",
    "Habitación": "Room",
    "Tipo de habitación": "Room type",
    "Tipo de cama": "Bed type",
    "Cama": "Bed",
    "Equipaje": "Luggage",
    "Transporte": "Transport",
    "Check-ins": "Check-ins",
    "Aeropuerto": "Airport",
    "Check-out": "Check-out",
    "Marcar embarque / llegada": "Mark boarding / arrival",
    "Marcar check-in hotel": "Mark hotel check-in",
    "Marcar check-out hotel": "Mark hotel check-out",
    "Conductor": "Driver",
    "Vehículo": "Vehicle",
    "Tipo": "Type",
    "Cliente": "Client",
    "Participantes": "Participants",
    "Cliente": "Client",
    "Origen": "Origin",
    "Destino": "Destination",
    "Delegación": "Delegation",
    "Programación": "Scheduled",
    "Inicio": "Start",
    "Cierre": "End",
    "Estado": "Status",
    "Sin viajes registrados.": "No trips registered.",
    "Sin hoteles registrados.": "No hotels registered.",
    "Capacidad": "Capacity",
    "Disponibilidad": "Availability",
    "Monitoreo de viajes en curso y estado operativo.": "Monitoring ongoing trips and operational status.",
    "Disponibilidad en tiempo real por hotel y ocupación.": "Real-time availability by hotel and occupancy.",
    "Última actualización": "Last update",
    "Actualizando...": "Updating...",
    "Disponibles": "Available",
    "Ocupadas": "Occupied",
    "Ocupación": "Occupancy",
    "Dirección": "Address",
    "Habitaciones": "Rooms",
    "Camas": "Beds",
    "Foto conductor": "Driver photo"
  },
  pt: {
    "Overview": "Visão geral",
    "Maestros": "Cadastros",
    "Usuarios": "Usuários",
    "Operaciones": "Operações",
    "Control": "Controle",
    "Portales": "Portais",
    "Dashboard": "Painel",
    "Eventos": "Eventos",
    "Delegaciones": "Delegações",
    "Disciplinas": "Disciplinas",
    "Flota": "Frota",
    "Hotelería": "Hotelaria",
    "Proveedores": "Fornecedores",
    "Participantes": "Participantes",
    "Encargado de delegación": "Responsável pela delegação",
    "Sí": "Sim",
    "No": "Não",
    "Conductores": "Motoristas",
    "Viajes": "Viagens",
    "Tracking de viajes": "Rastreio de viagens",
    "Tracking hotelería": "Rastreio de hotelaria",
    "Incidentes": "Incidentes",
    "Reportes": "Relatórios",
    "Portal de usuario": "Portal do usuário",
    "Portal Conductor": "Portal do motorista",
    "Centro de control": "Centro de controle",
    "Estado general del evento": "Estado geral do evento",
    "Monitorea llegadas, asignaciones y cambios operativos en un solo tablero. Este resumen conecta los módulos de transporte, hotelería y usuarios en tiempo real.": "Monitore chegadas, atribuições e mudanças operacionais em um único painel. Este resumo conecta transporte, hotelaria e usuários em tempo real.",
    "Operativo": "Operacional",
    "Multievento": "Multievento",
    "Llegadas a tiempo": "Chegadas no horário",
    "12 delegaciones recibidas hoy": "12 delegações recebidas hoje",
    "Cambios trazados": "Mudanças rastreadas",
    "Ultimas 24 horas": "Últimas 24 horas",
    "Asignaciones activas": "Atribuições ativas",
    "Vehiculos y habitaciones": "Veículos e quartos",
    "Reclamos": "Reclamações",
    "Pendientes de cierre": "Pendentes de fechamento",
    "Prioridades operativas": "Prioridades operacionais",
    "Revisar la roaming list de la delegación CAN y cerrar asignaciones de habitaciones.": "Revisar a lista de roaming da delegação CAN e fechar atribuições de quartos.",
    "Validar cambio de ruta para vehículo 23 por congestión en el acceso norte.": "Validar mudança de rota para o veículo 23 devido à congestão no acesso norte.",
    "Coordinar el pre check-in digital con el hotel central para 2 delegaciones.": "Coordenar o pré check-in digital com o hotel central para 2 delegações.",
    "KPIs clave": "KPIs principais",
    "Tiempo promedio de asignacion": "Tempo médio de atribuição",
    "Adopcion App Conductor": "Adoção do app do motorista",
    "Servicios extra controlados": "Serviços extras controlados",
    "Reclamos por logística": "Reclamações de logística",
    "Idioma": "Idioma",
    "Español": "Espanhol",
    "English": "Inglês",
    "Português": "Português",
    "Modulo": "Módulo",
    "Editar registro": "Editar registro",
    "Nuevo registro": "Novo registro",
    "Cancelar edición": "Cancelar edição",
    "Selecciona una opcion": "Selecione uma opção",
    "No hay viajes asignados aún.": "Nenhuma viagem atribuída ainda.",
    "Selecciona una delegación para cargar deportistas.": "Selecione uma delegação para carregar atletas.",
    "Selecciona una delegación para cargar participantes.": "Selecione uma delegação para carregar participantes.",
    "Seleccionar todos": "Selecionar todos",
    "Limpiar": "Limpar",
    "Actualizar": "Atualizar",
    "Crear": "Criar",
    "Registros": "Registros",
    "Acciones": "Ações",
    "Refrescar": "Atualizar",
    "Sin registros aún.": "Sem registros ainda.",
    "Editar": "Editar",
    "Eliminar": "Excluir",
    "No se pudo cargar": "Não foi possível carregar",
    "No se pudo actualizar": "Não foi possível atualizar",
    "No se pudo subir la foto": "Não foi possível enviar a foto",
    "No se pudo leer la imagen": "Não foi possível ler a imagem",
    "Error al guardar": "Erro ao salvar",
    "Error al eliminar": "Erro ao excluir",
    "Consulta tu itinerario y confirma cada etapa del viaje.": "Confira seu itinerário e confirme cada etapa da viagem.",
    "Tu ID de deportista": "Seu ID de atleta",
    "Tu ID de usuario": "Seu ID de usuário",
    "Ver mi información": "Ver minhas informações",
    "Revisa tus viajes y reporta cada etapa del traslado.": "Revise suas viagens e reporte cada etapa do traslado.",
    "Tu ID de conductor": "Seu ID de motorista",
    "Ver mis viajes": "Ver minhas viagens",
    "Cargando...": "Carregando...",
    "Perfil": "Perfil",
    "Correo": "E-mail",
    "ID de conductor": "ID do motorista",
    "Foto": "Foto",
    "Subir foto": "Enviar foto",
    "Subiendo...": "Enviando...",
    "Sin foto": "Sem foto",
    "Viajes asignados": "Viagens atribuídas",
    "No hay viajes asignados aún.": "Nenhuma viagem atribuída ainda.",
    "Viaje": "Viagem",
    "Evento": "Evento",
    "Eventos": "Eventos",
    "Nombre": "Nome",
    "Fecha inicio": "Data de início",
    "Fecha término": "Data de término",
    "Disciplinas": "Disciplinas",
    "País": "País",
    "Número de vuelo": "Número do voo",
    "Aerolínea": "Companhia aérea",
    "Origen": "Origem",
    "Terminal": "Terminal",
    "Patente": "Placa",
    "Capacidad": "Capacidade",
    "Capacidad total": "Capacidade total",
    "Inventario por tipo de habitación": "Inventário por tipo de quarto",
    "Inventario por tipo de cama": "Inventário por tipo de cama",
    "Inventario de habitaciones": "Inventário de quartos",
    "Inventario de camas": "Inventário de camas",
    "Calculado automáticamente desde camas": "Calculado automaticamente a partir das camas",
    "Debes ingresar al menos una cama.": "Você deve inserir pelo menos uma cama.",
    "Habitaciones Single": "Quartos Single",
    "Habitaciones Double": "Quartos Double",
    "Habitaciones Triple": "Quartos Triple",
    "Habitaciones Suite": "Quartos Suite",
    "Camas Single": "Camas Single",
    "Camas Double": "Camas Double",
    "Camas Queen": "Camas Queen",
    "Camas King": "Camas King",
    "Estado": "Estado",
    "Nombre completo": "Nome completo",
    "RUT": "RUT",
    "Correo electrónico": "E-mail",
    "Solicita tu código": "Solicite seu código",
    "Código enviado al correo": "Código enviado para seu e-mail",
    "Enviando...": "Enviando...",
    "Volver": "Voltar",
    "El correo ingresado no está autorizado para solicitar el código.": "O e-mail informado não está autorizado a solicitar o código.",
    "El correo ingresado no corresponde a un conductor registrado.": "O e-mail informado não corresponde a um motorista registrado.",
    "Licencia": "Carteira",
    "Teléfono": "Telefone",
    "Tipo de vehículo": "Tipo de veículo",
    "Marca": "Marca",
    "Modelo": "Modelo",
    "Estado vehículo": "Status do veículo",
    "Foto del conductor": "Foto do motorista",
    "Dieta": "Dieta",
    "Tipo de equipaje": "Tipo de bagagem",
    "Hotel": "Hotel",
    "Vehículo": "Veículo",
    "Tipo de viaje": "Tipo de viagem",
    "Tipo de cliente": "Tipo de cliente",
    "Fecha programación": "Data de agendamento",
    "Disponible": "Disponível",
    "En servicio": "Em serviço",
    "Mantenimiento": "Manutenção",
    "Activo": "Ativo",
    "Inactivo": "Inativo",
    "Servicio": "Serviço",
    "Viaje": "Viagem",
    "Recogido": "Coletado",
    "Dejado en hotel": "Deixado no hotel",
    "Viaje completado": "Viagem concluída",
    "Tipo de usuario": "Tipo de usuário",
    "Vuelo": "Voo",
    "Hotel": "Hotel",
    "Transporte": "Transporte",
    "Arribo": "Chegada",
    "Habitación": "Quarto",
    "Tipo de habitación": "Tipo de quarto",
    "Tipo de cama": "Tipo de cama",
    "Cama": "Cama",
    "Equipaje": "Bagagem",
    "Transporte": "Transporte",
    "Check-ins": "Check-ins",
    "Aeropuerto": "Aeroporto",
    "Check-out": "Check-out",
    "Marcar embarque / llegada": "Marcar embarque / chegada",
    "Marcar check-in hotel": "Marcar check-in no hotel",
    "Marcar check-out hotel": "Marcar check-out no hotel",
    "Conductor": "Motorista",
    "Vehículo": "Veículo",
    "Tipo": "Tipo",
    "Cliente": "Cliente",
    "Participantes": "Participantes",
    "Cliente": "Cliente",
    "Origen": "Origem",
    "Destino": "Destino",
    "Delegación": "Delegação",
    "Programación": "Agendamento",
    "Inicio": "Início",
    "Cierre": "Fim",
    "Estado": "Estado",
    "Sin viajes registrados.": "Sem viagens registradas.",
    "Sin hoteles registrados.": "Sem hotéis registrados.",
    "Capacidad": "Capacidade",
    "Disponibilidad": "Disponibilidade",
    "Monitoreo de viajes en curso y estado operativo.": "Monitoramento de viagens em curso e status operacional.",
    "Disponibilidad en tiempo real por hotel y ocupación.": "Disponibilidade em tempo real por hotel e ocupação.",
    "Última actualización": "Última atualização",
    "Actualizando...": "Atualizando...",
    "Disponibles": "Disponíveis",
    "Ocupadas": "Ocupadas",
    "Ocupación": "Ocupação",
    "Dirección": "Endereço",
    "Habitaciones": "Quartos",
    "Camas": "Camas",
    "Foto conductor": "Foto do motorista"
  }
};

const I18nContext = createContext<I18nContextValue | null>(null);

export function LanguageProvider({ children }: { children: React.ReactNode }) {
  const [locale, setLocale] = useState<Locale>("es");

  useEffect(() => {
    if (typeof window === "undefined") return;
    const stored = window.localStorage.getItem("seven.locale");
    if (stored === "es" || stored === "en" || stored === "pt") {
      setLocale(stored);
    }
  }, []);

  useEffect(() => {
    if (typeof window === "undefined") return;
    window.localStorage.setItem("seven.locale", locale);
    document.documentElement.lang = locale;
  }, [locale]);

  const value = useMemo<I18nContextValue>(() => {
    return {
      locale,
      setLocale,
      t: (value: string) => translations[locale]?.[value] ?? value
    };
  }, [locale]);

  return <I18nContext.Provider value={value}>{children}</I18nContext.Provider>;
}

export function useI18n() {
  const context = useContext(I18nContext);
  if (!context) {
    throw new Error("useI18n must be used within LanguageProvider");
  }
  return context;
}
